; This example originally appeared in TestingGuide.rst except here we've added
; echo to the clang/FileCheck command line to be executed.

; DEFINE: %{triple} =
; DEFINE: %{check}( CFLAGS %, FC_PREFIX %) =                                   \
; DEFINE:   echo '                                                             \
; DEFINE:   %clang_cc1 -verify -fopenmp -fopenmp-version=51 %{CFLAGS}          \
; DEFINE:              -triple %{triple} -emit-llvm -o - %s |                  \
; DEFINE:     FileCheck -check-prefix=%{FC_PREFIX} %s                          \
; DEFINE:   '

; DEFINE: %{check-triple} =                                                    \
; DEFINE:   %{check}(               %, CHECK %) &&                             \
; DEFINE:   %{check}( -fopenmp-simd %, SIMD  %)

; REDEFINE: %{triple} = x86_64-apple-darwin10.6.0
; RUN: %{check-triple}
; CHECK: %clang_cc1 -verify -fopenmp -fopenmp-version=51 -triple x86_64-apple-darwin10.6.0 -emit-llvm -o - {{.*}} | FileCheck -check-prefix=CHECK {{.*}}
; CHECK: %clang_cc1 -verify -fopenmp -fopenmp-version=51 -fopenmp-simd -triple x86_64-apple-darwin10.6.0 -emit-llvm -o - {{.*}} | FileCheck -check-prefix=SIMD {{.*}}

; REDEFINE: %{triple} = x86_64-unknown-linux-gnu
; RUN: %{check-triple}
; CHECK: %clang_cc1 -verify -fopenmp -fopenmp-version=51 -triple x86_64-unknown-linux-gnu -emit-llvm -o - {{.*}} | FileCheck -check-prefix=CHECK {{.*}}
; CHECK: %clang_cc1 -verify -fopenmp -fopenmp-version=51 -fopenmp-simd -triple x86_64-unknown-linux-gnu -emit-llvm -o - {{.*}} | FileCheck -check-prefix=SIMD {{.*}}

; CHECK: Passed: 1
