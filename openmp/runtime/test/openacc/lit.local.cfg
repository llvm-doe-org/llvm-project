# The OpenMP version required by the OpenACC implementation.
config.substitutions.append(('%fopenmp-version', '-fopenmp-version=51'))

config.substitutions.append(('%run-if-x86_64',
                             '' if config.clang_acc_test_exe_x86_64 else ':'))
config.substitutions.append(('%run-if-ppc64le',
                             '' if config.clang_acc_test_exe_ppc64le else ':'))
config.substitutions.append(('%run-if-nvptx64',
                             '' if config.clang_acc_test_exe_nvptx64 else ':'))
config.substitutions.append(('%run-x86_64-triple',
                             config.clang_acc_test_exe_x86_64_triple))
config.substitutions.append(('%run-ppc64le-triple',
                             config.clang_acc_test_exe_ppc64le_triple))
config.substitutions.append(('%run-nvptx64-triple',
                             config.clang_acc_test_exe_nvptx64_triple))

config.substitutions.append(('%acc-version', '201811'))
config.substitutions.append(('%acc-host-dev', '-10'))

# ../lit.cfg substitutes "tee %%t.out | FileCheck", which assumes input is
# piped, clobbers %t.out, and breaks substitutions like %run-if-nvptx64 because
# the ':' command shouldn't be used in front of a pipeline.  We want plain
# FileCheck here.
for i,s in enumerate(config.substitutions):
    if s[0] == 'FileCheck':
        config.substitutions[i] = ('FileCheck', config.test_filecheck)
